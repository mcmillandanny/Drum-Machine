{"version":3,"sources":["main.js"],"names":["console","log","AudioContext","window","webkitAudioContext","audioCtx","analyser","createAnalyser","kickAudio","document","querySelector","snareAudio","clapAudio","hihatAudio","boomAudio","kickTrack","createMediaElementSource","snareTrack","clapTrack","hihatTrack","boomTrack","kickPlayBtn","snarePlayBtn","clapPlayBtn","hihatPlayBtn","boomPlayBtn","lowShelfFilter","createBiquadFilter","type","gain","value","frequency","getRandomColor","letters","color","i","Math","floor","random","addEventListener","connect","destination","state","resume","play","pannerOptions","pan","panner","StereoPannerNode","panSlider","WIDTH","HEIGHT","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","getByteTimeDomainData","canvasCtx","getContext","clearRect","draw","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","sliceWidth","x","v","y","moveTo","lineTo","width","height","stroke","requestAnimationFrame","recorder","gumStream","recordButton","getElementById","toggleRecording","stop","getAudioTracks","navigator","mediaDevices","getUserMedia","audio","then","stream","MediaRecorder","ondataavailable","e","url","URL","createObjectURL","data","preview","createElement","controls","src","body","appendChild","start"],"mappings":"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","file":"main.js","sourcesContent":["console.log(\"Drum Machine\");\n\n\n\n// for cross browser\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst audioCtx = new AudioContext();\nconst analyser = audioCtx.createAnalyser();\n\n\n\n// load some sound\nconst kickAudio = document.querySelector('audio.kickAudio');\nconst snareAudio = document.querySelector('audio.snareAudio');\nconst clapAudio = document.querySelector('audio.clapAudio');\nconst hihatAudio = document.querySelector('audio.hihatAudio');\nconst boomAudio = document.querySelector('audio.boomAudio');\n\n\n\nconst kickTrack = audioCtx.createMediaElementSource(kickAudio);\nconst snareTrack = audioCtx.createMediaElementSource(snareAudio);\nconst clapTrack = audioCtx.createMediaElementSource(clapAudio);\nconst hihatTrack = audioCtx.createMediaElementSource(hihatAudio);\nconst boomTrack = audioCtx.createMediaElementSource(boomAudio);\n\n\nconst kickPlayBtn = document.querySelector('.kickPlayButton');\nconst snarePlayBtn = document.querySelector('.snarePlayButton');\nconst clapPlayBtn = document.querySelector('.clapPlayButton');\nconst hihatPlayBtn = document.querySelector('.hihatPlayButton');\nconst boomPlayBtn = document.querySelector('.boomPlayButton');\n\n\n\nlet lowShelfFilter = audioCtx.createBiquadFilter();\nlowShelfFilter.type = \"lowshelf\";\nlowShelfFilter.gain.value = 0;\nlowShelfFilter.frequency.value = 4000;\n\nfunction getRandomColor() {\n    var letters = '0123456789ABCDEF';\n    var color = '#';\n\n    for (var i = 0; i < 6; i++) {\n      color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n  }\n\n\n\n\n\n// make range slider control lowShelfFilter.frequency.value\ndocument.querySelector('.lowShelfSlider').addEventListener('change', function() {\n    lowShelfFilter.gain.value = this.value;\n})\n\nkickTrack\n    .connect(analyser) \n    .connect(lowShelfFilter) \n    .connect(audioCtx.destination)\n\nsnareTrack\n    .connect(analyser) \n    .connect(lowShelfFilter)\n    .connect(audioCtx.destination)\n    \n\nclapTrack \n    .connect(analyser) \n    .connect(lowShelfFilter)\n    .connect(audioCtx.destination)\n    \n    \n\nhihatTrack\n    .connect(analyser)    \n    .connect(lowShelfFilter)\n    .connect(audioCtx.destination)\n\nboomTrack\n    .connect(analyser)    \n    .connect(lowShelfFilter)\n    .connect(audioCtx.destination)\n    \n   \n\n\n\n// play pause audio\n\nkickPlayBtn.addEventListener(\"click\", function() {\n\n    if (audioCtx.state === 'suspended') {\n        audioCtx.resume();\n    }\n    // audioCtx.play();\n    kickAudio.play();\n\n})\n\nsnarePlayBtn.addEventListener(\"click\", function() {\n\n    if (audioCtx.state === 'suspended') {\n        audioCtx.resume();\n    }\n    // audioCtx.play();\n    snareAudio.play();\n\n})\n\nclapPlayBtn.addEventListener(\"click\", function() {\n\n    if (audioCtx.state === 'suspended') {\n        audioCtx.resume();\n    }\n    // audioCtx.play();\n    clapAudio.play();\n\n})\n\nhihatPlayBtn.addEventListener(\"click\", function () {\n\n    if (audioCtx.state === 'suspended') {\n        audioCtx.resume();\n    }\n    // audioCtx.play();\n    hihatAudio.play();\n\n})\n\nboomPlayBtn.addEventListener(\"click\", function() {\n\n    if (audioCtx.state === 'suspended') {\n        audioCtx.resume();\n    }\n    // audioCtx.play();\n    boomAudio.play();\n\n})\n\n\n// volume\n    // const gainNode = audioCtx.createGain();\n\n    // const volumeControl = document.querySelector('[data-action=\"volume\"]');\n    // volumeControl.addEventListener('input', function() {\n    //     gainNode.gain.value = this.value;\n    // }, false);\n\n// panning\nconst pannerOptions = {pan: 0};\nconst panner = new StereoPannerNode(audioCtx, pannerOptions);\nlet panSlider = document.querySelector('[data-action=\"panner\"]');\n\n\npanSlider.addEventListener('input', function() {\n    panner.pan.value = panSlider.value; \n\n})\n\n\n\n// canvas visualizer experiment \n\nlet WIDTH = 500;\nlet HEIGHT = 500;\n\nanalyser.fftSize = 2048;\nvar bufferLength = analyser.frequencyBinCount;\nvar dataArray = new Uint8Array(bufferLength);\n\nanalyser.getByteTimeDomainData(dataArray);\n\n\nlet canvasCtx = document.querySelector('#visualizer-canvas').getContext('2d');\ncanvasCtx.clearRect(0, 0, WIDTH, HEIGHT);\n\n\n\nfunction draw() {\n    // console.log(\"draw function!\")\n    analyser.getByteTimeDomainData(dataArray);\n    canvasCtx.fillStyle = 'rgb(100, 100, 100)';\n    canvasCtx.fillRect(0, 0, WIDTH, HEIGHT);\n    canvasCtx.lineWidth = 2;\n    canvasCtx.strokeStyle = getRandomColor();\n    canvasCtx.beginPath();\n    var sliceWidth = WIDTH * 1.0 / bufferLength;\n    var x = 0;\n\n\n    for(var i = 0; i < bufferLength; i++) {\n        \n        var v = dataArray[i] / 128.0;\n        var y = v * HEIGHT/2;\n        \n        if(i === 0) {\n            canvasCtx.moveTo(x, y);\n        } else {\n            canvasCtx.lineTo(x, y);\n        }\n        \n        x += sliceWidth;\n    }\n    \n    for(var i = 0; i < bufferLength; i++) {\n        \n        var v = dataArray[i] / 128.0;\n        var y = v * HEIGHT/2;\n        \n        if(i === 0) {\n            canvasCtx.moveTo(x, y);\n        } else {\n            canvasCtx.lineTo(x, y);\n        }\n        \n        x += sliceWidth;\n    }\n    \n    canvasCtx.lineTo(canvasCtx.width, canvasCtx.height/2);\n    canvasCtx.stroke();\n    \n    requestAnimationFrame(draw);\n    \n};\n\ndraw()\n\nvar recorder, gumStream;\nvar recordButton = document.getElementById(\"recordButton\");\nrecordButton.addEventListener(\"click\", toggleRecording);\n\nfunction toggleRecording() {\n    if (recorder && recorder.state == \"recording\") {\n        recorder.stop();\n        gumStream.getAudioTracks()[0].stop();\n    } else {\n        navigator.mediaDevices.getUserMedia({\n            audio: true\n        }).then(function(stream) {\n            gumStream = stream;\n            recorder = new MediaRecorder(stream);\n            recorder.ondataavailable = function(e) {\n                var url = URL.createObjectURL(e.data);\n                var preview = document.createElement('audio');\n                preview.controls = true;\n                preview.src = url;\n                document.body.appendChild(preview);\n            };\n            recorder.start();\n        });\n    }\n}\n\n// console.log(bufferLength)\n\n\n\n"]}